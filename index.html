<html lang="es"> <head> <meta charset="utf-8" /> <meta name="viewport" content="width=device-width,initial-scale=1" /> <title>Servidor - MINECRAFT JAVA Y BEDROCK EDITION</title> <!-- Fuente pixelada para el título --> <link href="https://fonts.googleapis.com/css2?family=Press+Start+2P&display=swap" rel="stylesheet"> <style> :root{ --bg:#0b1220; --card:#0f1a2b; --accent:#6ee7b7; --muted:#9fb0c8; }
        /* Usar la fuente pixelada de "Press Start 2P" para TODO el texto */
        html,body{
            height:100%;
            margin:0;
            /* sustituir la familia por la fuente pixelada (fallback monospace) */
            font-family: "Press Start 2P", monospace;
            /* aumentar tamaño base y espaciado para mejorar legibilidad */
            font-size:14px;
            letter-spacing: 0.12em;
        }
        body{
            background: linear-gradient(180deg, #071021 0%, #071a2b 60%), radial-gradient(1200px 600px at 10% 10%, rgba(110,231,183,0.04), transparent 10%);
            color:#e6f0fb;
            /* volver a suavizado para mejorar lectura con la fuente pixelada */
            -webkit-font-smoothing: antialiased;
            -moz-osx-font-smoothing: grayscale;
            text-rendering: optimizeLegibility;
            padding:2.5rem;
        }

        /* Logo flotante arriba a la izquierda */
        .logo-outer{
            position:fixed;
            top:18px;
            left:18px;
            width:72px;
            height:72px;
            z-index:50;
            filter:drop-shadow(0 6px 18px rgba(2,6,23,0.7));
            cursor:default;
            user-select:none;
            display:flex;
            align-items:center;
            justify-content:center;
            transform-origin:center;
            animation: float 4s ease-in-out infinite;
        }
        @keyframes float{
            0%{transform: translateY(0) rotate(-1deg)}
            50%{transform: translateY(-8px) rotate(1deg)}
            100%{transform: translateY(0) rotate(-1deg)}
        }
        /* Pixel-art "logo" (estilo bloque) */
        .logo-svg{
            width:64px;
            height:64px;
            image-rendering:pixelated;
            shape-rendering:crispEdges;
            image-rendering: -webkit-optimize-contrast;
        }

        main{
            max-width:980px;
            margin:0 auto;
            display:grid;
            grid-template-columns:1fr;
            gap:1.25rem;
        }

        header{
            display:flex;
            align-items:center;
            gap:1rem;
        }

        /* TÍTULO: mayúsculas y pixelado (solo el título) */
        .title{
            font-family: "Press Start 2P", monospace;
            font-size:18px;
            /* aumentar espaciado en el título */
            letter-spacing:0.16em;
            text-transform:uppercase;
            color:var(--accent);
            margin:0;
            line-height:1;
            text-shadow: 0 2px 0 rgba(2,6,23,0.6);
        }

        .subtitle{
            font-size:11px;
            color:var(--muted);
            margin:0;
            letter-spacing:0.12em;
        }

        .card{
            background: linear-gradient(180deg, rgba(255,255,255,0.02), rgba(255,255,255,0.01));
            border:1px solid rgba(255,255,255,0.03);
            padding:1.25rem;
            border-radius:12px;
            box-shadow: 0 6px 24px rgba(2,6,23,0.5);
        }

        .grid{
            display:grid;
            grid-template-columns: repeat(auto-fit,minmax(220px,1fr));
            gap:1rem;
        }

        .server-block{
            background: linear-gradient(180deg, rgba(255,255,255,0.015), transparent);
            border-radius:8px;
            padding:1rem;
            display:flex;
            flex-direction:column;
            gap:0.5rem;
            align-items:flex-start;
        }

        .server-name{
            font-weight:700;
            color:#fff;
            font-size:12px;
            letter-spacing:0.12em;
        }
        .server-desc{
            font-size:11px;
            color:var(--muted);
            letter-spacing:0.12em;
        }
        .ip{
            margin-top:0.25rem;
            font-family: "Press Start 2P", monospace;
            background:rgba(0,0,0,0.16);
            padding:0.4rem 0.6rem;
            border-radius:6px;
            color:#dff9ed;
            font-size:11px;
            letter-spacing:0.16em;
        }

        .btn{
            border:0;
            padding:0.45rem 0.75rem;
            border-radius:8px;
            background:linear-gradient(180deg,var(--accent), #2ad09a);
            color:#032018;
            font-weight:700;
            cursor:pointer;
            margin-left:auto;
            box-shadow: 0 6px 18px rgba(46, 189, 145, 0.12);
            font-size:11px;
            letter-spacing:0.12em;
        }

        /* Kebab menu */
        .kebab{
            /* botón fijo y flotante en la esquina superior derecha */
            position:fixed;
            top:18px;
            right:18px;
            margin:0;
            z-index:1200; /* alto para garantizar que quede por encima del contenido */
            display:flex;
            align-items:center;
            justify-content:center;
        }
        .kebab-btn{
            background:transparent;
            border:0;
            color:var(--muted);
            font-size:20px;
            padding:6px;
            cursor:pointer;
            border-radius:6px;
            display:flex;
            align-items:center;
            justify-content:center;
            width:40px;
            height:40px;
        }
        /* tamaño/estilo del icono kebab y trazo de las barras */
        .kb-icon{ width:20px; height:16px; display:block; }
        .kb-bar{
            stroke: currentColor;
            stroke-width: 2;
            stroke-linecap: round;
            fill: none;
        }

        .kebab-menu{
            position:absolute;
            right:0;
            /* colocar justo debajo del botón */
            top: calc(100% + 6px);
            background:var(--card);
            border:1px solid rgba(255,255,255,0.03);
            border-radius:8px;
            padding:8px;
            /* hidden by default; shown only when .open */
            display:block;
            min-width:180px;
            box-shadow:0 10px 30px rgba(2,6,23,0.6);
            z-index:1000;
            /* organizar opciones en columna y que el contenedor crezca con su contenido */
            display:block; /* keep it block by default for measurement, hidden via .kebab-menu:not(.open){display:none} below */
            box-sizing:border-box;
        }
        /* ocultar completamente cuando NO está abierto (mejor que solo opacity:0) */
        .kebab-menu:not(.open){ display:none; }

        /* animación de apertura y aparición de items */
        .kebab-menu{ transform-origin: top right; transform: scale(.96); opacity:0; transition: transform .18s ease, opacity .18s ease; }
        .kebab-menu.open{ transform: scale(1); opacity:1; }
        .kebab-menu button{ opacity:0; transform: translateY(-6px); transition: transform .20s ease, opacity .20s ease; }
        .kebab-menu.open button{ opacity:1; transform: translateY(0); }
        /* stagger para una sensación más fluida */
        .kebab-menu.open button:nth-child(1){ transition-delay:0s }
        .kebab-menu.open button:nth-child(2){ transition-delay:.03s }
        .kebab-menu.open button:nth-child(3){ transition-delay:.06s }
        .kebab-menu.open button:nth-child(4){ transition-delay:.09s }
        .kebab-menu.open button:nth-child(5){ transition-delay:.12s }
        .kebab-menu.open button:nth-child(6){ transition-delay:.15s }

        /* indicador de carga en el propio botón kebab (mientras overlay está visible) */
        .kebab-btn.loading::after{
            content: '';
            display: inline-block;
            width: 12px;
            height: 12px;
            margin-left: 6px;
            border-radius: 50%;
            border: 2px solid rgba(255,255,255,0.18);
            border-top-color: var(--accent);
            animation: spin 0.9s linear infinite;
            vertical-align: middle;
        }

        /* Loader overlay + spinner */
        .loader-overlay{
            position:fixed;
            inset:0;
            display:flex;
            align-items:center;
            justify-content:center;
            background:rgba(2,6,23,0.6);
            z-index:1300; /* subir por encima del kebab (1200) para que se vea el overlay) */
            opacity:0;
            pointer-events:none;
            transition:opacity .28s ease;
        }
        .loader-overlay.show{ opacity:1; pointer-events:auto; }
        .spinner{
            width:64px;height:64px;border-radius:8px;
            background:linear-gradient(180deg,#0f1a2b,#0b1220);
            display:flex;align-items:center;justify-content:center;
            box-shadow: 0 6px 20px rgba(2,6,23,0.7);
            border:4px solid rgba(110,231,183,0.08);
        }
        .spinner::after{
            content:'';
            width:28px;height:28px;border-radius:50%;
            border:4px solid transparent;
            border-top-color:var(--accent);
            animation:spin 1s linear infinite;
        }
        @keyframes spin{ to{ transform:rotate(360deg) } }

        /* Section transitions */
        .content-section{ transition:opacity .34s ease, transform .34s ease; }
        .hidden{ opacity:0; transform:translateY(6px); pointer-events:none; height:0; overflow:hidden; }
        .visible{ opacity:1; transform:translateY(0); pointer-events:auto; height:auto; }

        .row{display:flex;gap:0.5rem;align-items:center;width:100%}
        footer{margin-top:1rem;color:var(--muted);font-size:11px;text-align:center; letter-spacing:0.08em;}
        @media (max-width:520px){
            .title{font-size:14px}
        }
    </style>
</head>
<body>

    <!-- Logo flotante pixelado (SVG de bloque estilo "grass block" simple) -->
    <div class="logo-outer" title="Servidor">
        <svg class="logo-svg" viewBox="0 0 64 64" xmlns="http://www.w3.org/2000/svg" shape-rendering="crispEdges">
            <!-- capa superior: césped (verde) -->
            <rect x="0" y="0" width="64" height="16" fill="#63b54c"/>
            <rect x="0" y="16" width="64" height="4" fill="#3f8f2f"/>
            <!-- cuerpo: tierra -->
            <rect x="0" y="20" width="64" height="28" fill="#8b5a32"/>
            <!-- sombreado y pixeles -->
            <rect x="6" y="24" width="6" height="6" fill="#6e3f1e"/>
            <rect x="36" y="28" width="4" height="4" fill="#5b3822"/>
            <rect x="48" y="30" width="3" height="3" fill="#6e3f1e"/>
            <!-- borde -->
            <rect x="0" y="48" width="64" height="16" fill="#4a2f20"/>
            <!-- contorno tenue -->
            <rect x="0.5" y="0.5" width="63" height="63" fill="none" stroke="#00000033" stroke-width="1"/>
        </svg>
    </div> <!-- .logo-outer -->

    <!-- Kebab menu (flotante) - moved outside header for visibility -->
    <div class="kebab" aria-hidden="false">
        <button class="kebab-btn" id="kebab-btn" aria-label="Abrir menú">
            <svg class="kb-icon kebab-float" viewBox="0 0 20 16" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" role="img" aria-label="Menú">
                <path class="kb-bar" d="M1 2.5 L19 2.5" />
                <path class="kb-bar" d="M1 8 L19 8" />
                <path class="kb-bar" d="M1 13.5 L19 13.5" />
            </svg>
        </button>
        <div class="kebab-menu" id="kebab-menu" role="menu" aria-hidden="true">
            <button data-section="inicio">Inicio</button>
            <button data-section="tienda">Tienda</button>
            <button data-section="actualizaciones">Actualizaciones</button>
            <button data-section="comunidad">Comunidad</button>
            <button data-section="administradores">Administradores</button>
            <button data-section="feedback">Feedback</button>
        </div>
    </div>

    <main>
        <header>
            <div>
                <h1 class="title">MINECRAFT JAVA Y BEDROCK EDITION</h1>
                <p class="subtitle">Página informativa del servidor — compatible con Java y Bedrock</p>
            </div>
        </header>

        <!-- Contenedores por sección: Inicio (original), Rango, Admin, Redes -->
        <section id="app-content">
            <!-- Inicio: contenido original -->
            <section class="card content-section visible" data-section="inicio" id="section-inicio">
                <div class="grid">
                    <div class="server-block">
                        <div class="row" style="width:100%">
                            <div>
                                <div class="server-name">Servidor Java</div>
                                <div class="server-desc">Conéctate usando la IP y puerto de Java (ativa plugins/mods según configuración).</div>
                                <div class="ip" id="java-ip">play.ejemplo-servidor.com:25565</div>
                            </div>
                        </div>
                    </div>

                    <div class="server-block">
                        <div class="row" style="width:100%">
                            <div>
                                <div class="server-name">Servidor Bedrock</div>
                                <div class="server-desc">Usa esta IP en la edición Bedrock (móvil/Windows 10/Consolas).</div>
                                <div class="ip" id="bedrock-ip">play.ejemplo-servidor.com:19132</div>
                            </div>
                        </div>
                    </div>

                    <div class="server-block" style="grid-column: span 2;">
                        <div class="server-name">Estado</div>
                        <div class="server-desc" id="status">Comprobando estado del servidor...</div>
                        <div style="margin-top:0.6rem;font-size:13px;color:var(--muted)">Última comprobación: <span id="checked-time">—</span></div>
                    </div>
                </div>
            </section>

            <!-- Tienda / Rangos -->
            <section class="card content-section hidden" data-section="tienda" id="section-tienda" aria-hidden="true">
                <div class="server-name">Tienda de Rangos</div>
                <div class="server-desc">Compra un rango. Al pagar incluye tu nombre de jugador y, en la descripción del pago, tu nombre Java y/o Bedrock si aplica.</div>

                <div style="margin-top:0.8rem" class="grid">
                    <!-- Producto: Elite -->
                    <div class="server-block">
                        <div class="row" style="width:100%">
                            <img alt="Elite" width="48" height="48" src='data:image/svg+xml;utf8,<svg xmlns="http://www.w3.org/2000/svg" width="48" height="48"><rect width="48" height="48" fill="%2363b54c"/><text x="50%" y="60%" font-size="10" text-anchor="middle" fill="white">E</text></svg>' />
                            <div style="margin-left:8px">
                                <div class="server-name">Elite <span style="font-weight:400;color:var(--muted);font-size:11px"> $1.99</span></div>
                                <div class="server-desc">Rango inicial con beneficios básicos de chat y prefijo.</div>
                                <div style="margin-top:6px"><button class="btn buy-btn" data-id="elite" data-price="1.99" data-title="Elite">Comprar</button></div>
                            </div>
                        </div>
                    </div>

                    <!-- Producto: Vip -->
                    <div class="server-block">
                        <div class="row" style="width:100%">
                            <img alt="Vip" width="48" height="48" src='data:image/svg+xml;utf8,<svg xmlns="http://www.w3.org/2000/svg" width="48" height="48"><rect width="48" height="48" fill="%232ad09a"/><text x="50%" y="60%" font-size="10" text-anchor="middle" fill="white">V</text></svg>' />
                            <div style="margin-left:8px">
                                <div class="server-name">Vip <span style="font-weight:400;color:var(--muted);font-size:11px"> $2.99</span></div>
                                <div class="server-desc">Acceso rápido a comandos exclusivos y kits mensuales.</div>
                                <div style="margin-top:6px"><button class="btn buy-btn" data-id="vip" data-price="2.99" data-title="Vip">Comprar</button></div>
                            </div>
                        </div>
                    </div>

                    <!-- Producto: Aether -->
                    <div class="server-block">
                        <div class="row" style="width:100%">
                            <img alt="Aether" width="48" height="48" src='data:image/svg+xml;utf8,<svg xmlns="http://www.w3.org/2000/svg" width="48" height="48"><rect width="48" height="48" fill="%2366a1ff"/><text x="50%" y="60%" font-size="10" text-anchor="middle" fill="white">A</text></svg>' />
                            <div style="margin-left:8px">
                                <div class="server-name">Aether <span style="font-weight:400;color:var(--muted);font-size:11px"> $3.99</span></div>
                                <div class="server-desc">Rango avanzado con permisos ampliados y más slots.</div>
                                <div style="margin-top:6px"><button class="btn buy-btn" data-id="aether" data-price="3.99" data-title="Aether">Comprar</button></div>
                            </div>
                        </div>
                    </div>

                    <!-- Producto: Aether Supremo -->
                    <div class="server-block" style="grid-column: span 2;">
                        <div class="row" style="width:100%">
                            <img alt="Aether Supremo" width="48" height="48" src='data:image/svg+xml;utf8,<svg xmlns="http://www.w3.org/2000/svg" width="48" height="48"><rect width="48" height="48" fill="%23f5c542"/><text x="50%" y="60%" font-size="9" text-anchor="middle" fill="black">AS</text></svg>' />
                            <div style="margin-left:8px">
                                <div class="server-name">Aether Supremo <span style="font-weight:400;color:var(--muted);font-size:11px"> $5.99</span></div>
                                <div class="server-desc">Rango premium con todos los permisos, efectos exclusivos y prioridad.</div>
                                <div style="margin-top:6px"><button class="btn buy-btn" data-id="aether-supremo" data-price="5.99" data-title="Aether Supremo">Comprar</button></div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Modal / formulario de compra (hidden) -->
                <div id="purchase-modal" class="card hidden" aria-hidden="true" style="position:relative;margin-top:12px">
                    <div class="server-name" id="modal-title">Comprar</div>
                    <div class="server-desc" id="modal-sub">Detalles del producto</div>

                    <div style="margin-top:10px;display:flex;flex-direction:column;gap:8px">
                        <label style="font-size:11px;color:var(--muted)">Tu nombre de jugador (obligatorio)</label>
                        <input id="payer-username" placeholder="ej. Notch123" style="width:100%;padding:8px;border-radius:6px;border:1px solid rgba(255,255,255,0.03);background:transparent;color:#e6f0fb;font-family:inherit">

                        <label style="font-size:11px;color:var(--muted)">Nombre Java (opcional)</label>
                        <input id="java-name" placeholder="ej. Notch_Java" style="width:100%;padding:8px;border-radius:6px;border:1px solid rgba(255,255,255,0.03);background:transparent;color:#e6f0fb;font-family:inherit">

                        <label style="font-size:11px;color:var(--muted)">Nombre Bedrock (opcional)</label>
                        <input id="bedrock-name" placeholder="ej. Notch_Bedrock" style="width:100%;padding:8px;border-radius:6px;border:1px solid rgba(255,255,255,0.03);background:transparent;color:#e6f0fb;font-family:inherit">

                        <label style="font-size:11px;color:var(--muted)">Método de pago</label>
                        <select id="payment-method" style="padding:8px;border-radius:6px;background:transparent;color:#e6f0fb">
                            <option value="paypal">PayPal</option>
                            <option value="googlepay">Google Pay / Pay</option>
                            <option value="other">Otro (manual)</option>
                        </select>

                        <div style="display:flex;gap:8px;align-items:center">
                            <button id="pay-now" class="btn">Pagar</button>
                            <button id="cancel-pay" class="kebab-btn" style="background:transparent;color:var(--muted)">Cancelar</button>
                        </div>

                        <div id="payment-instructions" style="font-size:11px;color:var(--muted);margin-top:6px"></div>
                    </div>
                </div>
            </section>

            <!-- Administradores -->
            <section class="card content-section hidden" data-section="administradores" id="section-admin" aria-hidden="true">
                <div class="server-name">Administrativo</div>
                <div class="server-desc">Herramientas y contactos para el equipo administrativo.</div>
                <ul style="margin-top:0.6rem;color:var(--muted);font-size:11px">
                    <li>Contactar: admin@ejemplo.com</li>
                    <li>Reportes: sistema interno</li>
                </ul>
            </section>

            <!-- Comunidad (antes redes) -->
            <section class="card content-section hidden" data-section="comunidad" id="section-redes" aria-hidden="true">
                <div class="server-name">Comunidad</div>
                <div class="server-desc">Enlaces y canales para conectar con la comunidad.</div>
                <div style="margin-top:0.6rem;display:flex;gap:8px">
                    <a href="#" style="color:var(--accent);font-size:11px;text-decoration:none">Twitter</a>
                    <a href="#" style="color:var(--accent);font-size:11px;text-decoration:none">Discord</a>
                    <a href="#" style="color:var(--accent);font-size:11px;text-decoration:none">YouTube</a>
                </div>
            </section>

            <!-- Actualizaciones (nueva sección) -->
            <section class="card content-section hidden" data-section="actualizaciones" id="section-actualizaciones" aria-hidden="true">
                <div class="server-name">Actualizaciones</div>
                <div class="server-desc">Últimas notas de parche, mantenimiento y novedades del servidor.</div>
                <ul style="margin-top:0.6rem;color:var(--muted);font-size:11px">
                    <li>v1.2 - Nuevos kits</li>
                    <li>v1.1 - Corrección de exploits</li>
                </ul>
            </section>

            <!-- Feedback (nueva sección) -->
            <section class="card content-section hidden" data-section="feedback" id="section-feedback" aria-hidden="true">
                <div class="server-name">Feedback</div>
                <div class="server-desc">Envíanos sugerencias o reportes. Un administrador te responderá.</div>
                <div style="margin-top:0.8rem">
                    <label style="display:block;font-size:10px;color:var(--muted);margin-bottom:6px">Tu usuario</label>
                    <input id="fb-usuario" style="width:100%;padding:8px;border-radius:6px;border:1px solid rgba(255,255,255,0.03);background:transparent;color:#e6f0fb;font-family:inherit" placeholder="ej. Notch123">
                    <div style="height:8px"></div>
                    <label style="display:block;font-size:10px;color:var(--muted);margin-bottom:6px">Mensaje</label>
                    <textarea id="fb-mensaje" style="width:100%;min-height:80px;padding:8px;border-radius:6px;border:1px solid rgba(255,255,255,0.03);background:transparent;color:#e6f0fb;font-family:inherit"></textarea>
                    <div style="height:8px"></div>
                    <button id="fb-enviar" class="btn" style="font-size:11px">Enviar feedback</button>
                    <div id="fb-msg" style="font-size:11px;color:var(--muted);margin-top:8px"></div>
                </div>
            </section>
        </section>

        <footer class="card">
        </footer>
    </main>

    <!-- Loader overlay -->
    <div id="loader" class="loader-overlay" aria-hidden="true">
        <div class="spinner" role="status" aria-label="Cargando"></div>
    </div>

    <script>
        /* Reemplaza el antiguo JS de copiado: nueva lógica de menú y cambio de secciones con loader/animación */
        (function(){
            const kebabBtn = document.getElementById('kebab-btn');
            const kebabMenu = document.getElementById('kebab-menu');
            // validar que existan elementos antes de usar
            if(!kebabBtn || !kebabMenu){
                console.warn('Kebab elements missing; aborting menu init.');
                return;
            }
            // el icono de rayas dentro del botón
            const kbIcon = kebabBtn.querySelector('.kb-icon');
            const loader = document.getElementById('loader');
            if(!loader) { console.warn('Loader element missing'); }
             // obtener secciones en tiempo real (no mantener una lista estática)
             function getSections(){ return Array.from(document.querySelectorAll('.content-section')); }
             function getVisibleSection(){ return getSections().find(s => s.classList.contains('visible')) || null; }

            function showMenu(toggle){
                if(toggle){
                    kebabMenu.classList.add('open');
                    kebabMenu.setAttribute('aria-hidden','false');
                    kebabBtn.setAttribute('aria-expanded','true');
                }else{
                    kebabMenu.classList.remove('open');
                    kebabMenu.setAttribute('aria-hidden','true');
                    kebabBtn.setAttribute('aria-expanded','false');
                }
            }

            // handle desktop click
            kebabBtn.addEventListener('click', (e)=> { e.stopPropagation(); showMenu(!kebabMenu.classList.contains('open')); });
            // handle touch on mobile (prevent duplicate click)
            kebabBtn.addEventListener('touchend', (e)=> { e.preventDefault(); e.stopPropagation(); showMenu(!kebabMenu.classList.contains('open')); }, { passive:false });
            // pointer fallback
            kebabBtn.addEventListener('pointerup', (e)=> { e.stopPropagation(); showMenu(!kebabMenu.classList.contains('open')); });

            // asegurar que tocar las rayas también abra/cierre el menú (click + touch para móviles)
            if(kbIcon){
                kbIcon.addEventListener('click', (e)=> { e.stopPropagation(); showMenu(!kebabMenu.classList.contains('open')); });
                kbIcon.addEventListener('touchend', (e)=> { e.preventDefault(); e.stopPropagation(); showMenu(!kebabMenu.classList.contains('open')); }, { passive:false });
                kbIcon.addEventListener('pointerup', (e)=> { e.stopPropagation(); showMenu(!kebabMenu.classList.contains('open')); });
            }
            // cerrar al clicar fuera SOLO si el menú está abierto
            document.addEventListener('click', (e)=>{
                if(kebabMenu.classList.contains('open') && !kebabMenu.contains(e.target) && e.target !== kebabBtn) showMenu(false);
            });
            // touchstart también cierra en móvil si se toca fuera
            // usamos passive:false porque llamamos a preventDefault()
            document.addEventListener('touchstart', (e)=>{
                if(kebabMenu.classList.contains('open') && !kebabMenu.contains(e.target) && e.target !== kebabBtn) {
                    e.preventDefault();
                    showMenu(false);
                }
            }, { passive:false });
            // cerrar con Escape
            document.addEventListener('keydown', (e)=>{
                if(e.key === 'Escape') showMenu(false);
            });

            // animaciones y cambio de sección
            function switchSection(targetKey){
                const current = getVisibleSection();
                const target = getSections().find(s => s.dataset.section === targetKey);
                if(!target || current === target) { showMenu(false); return; }

                // iniciar fade-out del actual
                if(current){
                    current.classList.remove('visible');
                    current.classList.add('hidden');
                    current.setAttribute('aria-hidden','true');
                }

                // mostrar loader (overlay) y marcar el botón kebab como "loading"
                loader.classList.add('show');
                loader.setAttribute('aria-hidden','false');
                kebabBtn.classList.add('loading');

                // simular tiempo de carga y luego mostrar la nueva sección con fade-in
                setTimeout(()=>{
                    // ocultar loader y quitar indicador de carga del botón
                    loader.classList.remove('show');
                    loader.setAttribute('aria-hidden','true');
                    kebabBtn.classList.remove('loading');
    
                    target.classList.remove('hidden');
                    // forzar reflow para garantizar transición
                    void target.offsetWidth;
                    target.classList.add('visible');
                    target.setAttribute('aria-hidden','false');
                    // accesibilidad: mover el foco al primer encabezado o al contenido
                    const focusable = target.querySelector('.server-name') || target;
                    if(focusable){
                        // aseguramos que sea focusable
                        try{ focusable.tabIndex = -1; }catch(e){}
                        if(typeof focusable.focus === 'function') focusable.focus();
                    }
    
                }, 800); // duración total de carga (ajustable)
    
                showMenu(false);
            }

            // asignar eventos a botones del menú (detener propagación y soportar teclado)
            kebabMenu.querySelectorAll('button[data-section]').forEach(btn=>{
                // desktop click
                btn.addEventListener('click', (e)=>{
                    e.stopPropagation();
                    switchSection(btn.getAttribute('data-section'));
                });
                // touch support
                btn.addEventListener('touchend', (e)=>{
                    e.preventDefault();
                    e.stopPropagation();
                    switchSection(btn.getAttribute('data-section'));
                }, { passive:false });
                // pointer fallback
                btn.addEventListener('pointerup', (e)=>{
                    e.stopPropagation();
                    switchSection(btn.getAttribute('data-section'));
                });
                // keyboard
                btn.addEventListener('keydown', (e)=>{
                    if(e.key === 'Enter' || e.key === ' '){
                        e.preventDefault();
                        e.stopPropagation();
                        switchSection(btn.getAttribute('data-section'));
                    }
                });
            });

            // pequeño handler para el feedback (simula envío)
            const fbEnviar = document.getElementById('fb-enviar');
            if(fbEnviar){
                fbEnviar.addEventListener('click', ()=>{
                    const user = document.getElementById('fb-usuario').value.trim();
                    const msg = document.getElementById('fb-mensaje').value.trim();
                    const fbMsg = document.getElementById('fb-msg');
                    if(!user || !msg){ fbMsg.textContent = 'Rellena usuario y mensaje.'; return; }
                    // simular envío y guardar en localStorage
                    const arr = JSON.parse(localStorage.getItem('feedbacks_v1') || '[]');
                    arr.push({ user, msg, at: new Date().toISOString() });
                    localStorage.setItem('feedbacks_v1', JSON.stringify(arr));
                    fbMsg.textContent = 'Feedback enviado. Gracias.';
                    document.getElementById('fb-usuario').value = '';
                    document.getElementById('fb-mensaje').value = '';
                });
            }

            // mantener la comprobación de estado existente (sin cambios funcionales)
            function checkServer(){
                const statusEl = document.getElementById('status');
                const t = new Date();
                document.getElementById('checked-time').textContent = t.toLocaleTimeString();
                const online = Math.random() > 0.25;
                if(online){
                    statusEl.textContent = 'ONLINE — 12 jugadores';
                    statusEl.style.color = '#bff8df';
                }else{
                    statusEl.textContent = 'OFFLINE — no responde';
                    statusEl.style.color = '#f8c6c6';
                }
            }
            checkServer();
            setInterval(checkServer, 15000);
+
+            // --- LÓGICA DE COMPRA DE RANGOS (frontend + "backend" simulado en localStorage) ---
+            const PRODUCTS = {
+                "elite": { title: "Elite", price: "1.99", desc: "Rango inicial con beneficios básicos." },
+                "vip": { title: "Vip", price: "2.99", desc: "Acceso a comandos exclusivos y kits." },
+                "aether": { title: "Aether", price: "3.99", desc: "Permisos ampliados y beneficios." },
+                "aether-supremo": { title: "Aether Supremo", price: "5.99", desc: "Rango premium con prioridad y extras." }
+            };
+
+            function saveOrder(order){
+                const key = 'mock_orders_v1';
+                const arr = JSON.parse(localStorage.getItem(key) || "[]");
+                arr.push(order);
+                localStorage.setItem(key, JSON.stringify(arr));
+                return order.id;
+            }
+
+            // Build PayPal payment URL (simple checkout link); incluye player y nombres en item_name/custom
+            function buildPayPalLink(businessEmail, productTitle, amount, playerName, javaName, bedrockName){
+                const base = 'https://www.paypal.com/cgi-bin/webscr';
+                const params = new URLSearchParams();
+                params.set('cmd','_xclick');
+                params.set('business', businessEmail);
+                params.set('amount', amount);
+                params.set('currency_code', 'USD');
+                // item_name visible en PayPal; incluimos jugador
+                const itemName = `${productTitle} — ${playerName}`;
+                params.set('item_name', itemName);
+                // custom para datos adicionales (no visibles en resumen principal)
+                const custom = `Player:${playerName};Java:${javaName||'-'};Bedrock:${bedrockName||'-'}`;
+                params.set('custom', custom);
+                // opcional: return/cancelar a esta página
+                params.set('return', location.href);
+                params.set('cancel_return', location.href);
+                return `${base}?${params.toString()}`;
+            }
+
+            // modal helpers
+            const modal = document.getElementById('purchase-modal');
+            const modalTitle = document.getElementById('modal-title');
+            const modalSub = document.getElementById('modal-sub');
+            const payerEl = document.getElementById('payer-username');
+            const javaEl = document.getElementById('java-name');
+            const bedrockEl = document.getElementById('bedrock-name');
+            const payMethodEl = document.getElementById('payment-method');
+            const payNowBtn = document.getElementById('pay-now');
+            const cancelPayBtn = document.getElementById('cancel-pay');
+            const instructionsEl = document.getElementById('payment-instructions');
+
+            let currentProduct = null;
+
+            // buy buttons (desktop + touch + pointer) - guard por si no existen
+            const buyBtns = document.querySelectorAll('.buy-btn') || [];
+            buyBtns.forEach(btn=>{
+                try{
+                    btn.addEventListener('click', ()=> openPurchase(btn.dataset.id));
+                    btn.addEventListener('touchend', (e)=>{ e.preventDefault(); e.stopPropagation(); openPurchase(btn.dataset.id); }, { passive:false });
+                    btn.addEventListener('pointerup', (e)=>{ e.stopPropagation(); openPurchase(btn.dataset.id); });
+                }catch(err){ /* ignore individual attach errors */ }
+            });
+
+            function openPurchase(productId){
+                const prod = PRODUCTS[productId];
+                if(!prod) return;
+                currentProduct = { id: productId, ...prod };
+                modalTitle.textContent = `Comprar: ${prod.title} — $${prod.price}`;
+                modalSub.textContent = prod.desc;
+                payerEl.value = '';
+                javaEl.value = '';
+                bedrockEl.value = '';
+                payMethodEl.value = 'paypal';
+                instructionsEl.textContent = '';
+                modal.classList.remove('hidden');
+                modal.classList.add('visible');
+                modal.setAttribute('aria-hidden','false');
+                // scroll into view for mobile
+                modal.scrollIntoView({ behavior:'smooth', block:'center' });
+            }
+
+            function closePurchase(){
+                modal.classList.remove('visible');
+                modal.classList.add('hidden');
+                modal.setAttribute('aria-hidden','true');
+                currentProduct = null;
+            }
+
+            // cancelar compra: solo si existe el botón
+            if(cancelPayBtn){
+                cancelPayBtn.addEventListener('click', ()=> closePurchase());
+                cancelPayBtn.addEventListener('touchend', (e)=>{ e.preventDefault(); e.stopPropagation(); closePurchase(); }, { passive:false });
+                cancelPayBtn.addEventListener('pointerup', (e)=>{ e.stopPropagation(); closePurchase(); });
+            }
+
+            if(payNowBtn){
+                payNowBtn.addEventListener('click', ()=>{
                 if(!currentProduct) return;
                 const player = payerEl.value.trim();
                 const javaName = javaEl.value.trim();
                 const bedrockName = bedrockEl.value.trim();
                 const method = payMethodEl.value;
                 if(!player){
                     instructionsEl.textContent = 'Debes indicar tu nombre de jugador antes de proceder.';
                     return;
                 }
 
                 const order = {
                     id: 'ORD-' + Date.now(),
                     product: currentProduct,
                     player,
                     javaName,
                     bedrockName,
                     method,
                     createdAt: new Date().toISOString()
                 };
                 saveOrder(order);
 
                 // PayPal flow (abre en nueva pestaña con descripción que incluye el nombre)
                 if(method === 'paypal'){
                     const url = buildPayPalLink('dragonhonest1@gmail.com', currentProduct.title, currentProduct.price, player, javaName, bedrockName);
                     window.open(url, '_blank');
                     instructionsEl.textContent = `Enlace de PayPal generado. Se abrió una pestaña para completar el pago. Orden ID: ${order.id}`;
                     // se puede cerrar automáticamente o dejar al usuario.
                 } else if(method === 'googlepay'){
                     // Google Pay real requiere integración de pagos; aquí damos instrucciones y copia de descripción
                     const text = `Enviar ${currentProduct.price} USD vía Google Pay a la cuenta habilitada del servidor. En la descripción indica: ${currentProduct.title} | Player:${player} | Java:${javaName||'-'} | Bedrock:${bedrockName||'-'}. Orden ID: ${order.id}`;
                     copyToClipboard(text);
                     instructionsEl.textContent = 'Instrucciones copiadas al portapapeles. Abre Google Pay y pega la descripción en la transferencia. Orden guardada localmente.';
                 } else {
                     const text = `Pagar ${currentProduct.price} USD por ${currentProduct.title}. Indica en la descripción: Player:${player} | Java:${javaName||'-'} | Bedrock:${bedrockName||'-'}. Orden ID: ${order.id}`;
                     copyToClipboard(text);
                     instructionsEl.textContent = 'Instrucciones copiadas al portapapeles. Puedes usar pago manual (transferencia/bizum/etc) y pegar la descripción en la nota.';
                 }
-            });
+                }); // end payNowBtn listener
+            } // end if payNowBtn

            // fin de la lógica de tienda
        })();
    </script>

</body>
</html>